<!DOCTYPE html>
<html>
<head>
  <title>MediSort - Premium Healthcare Platform</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- Leaflet CSS & JS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <!-- Leaflet Routing Machine -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.css" />
  <script src="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.js"></script>
  <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'sans-serif'],
            display: ['Playfair Display', 'serif'],
          },
          animation: {
            'float': 'float 6s ease-in-out infinite',
            'pulse-soft': 'pulse-soft 2s ease-in-out infinite',
            'shimmer': 'shimmer 2s linear infinite',
            'gradient': 'gradient 15s ease infinite',
          },
          keyframes: {
            float: {
              '0%, 100%': { transform: 'translateY(0px)' },
              '50%': { transform: 'translateY(-10px)' },
            },
            'pulse-soft': {
              '0%, 100%': { opacity: '1' },
              '50%': { opacity: '0.7' },
            },
            shimmer: {
              '0%': { transform: 'translateX(-100%)' },
              '100%': { transform: 'translateX(100%)' },
            },
            gradient: {
              '0%, 100%': { 'background-position': '0% 50%' },
              '50%': { 'background-position': '100% 50%' },
            },
          },
        },
      },
    }
  </script>
  <style>
    :root {
      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --warning-gradient: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
      --danger-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
      --surface: rgba(255, 255, 255, 0.95);
      --surface-glass: rgba(255, 255, 255, 0.1);
      --text-primary: #1a202c;
      --text-secondary: #4a5568;
      --text-muted: #718096;
      --border-subtle: rgba(255, 255, 255, 0.2);
      --shadow-elegant: 0 20px 40px -12px rgba(0, 0, 0, 0.1);
      --shadow-hover: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      background-size: 400% 400%;
      animation: gradient 15s ease infinite;
      color: var(--text-primary);
      margin: 0;
      padding: 0;
      min-height: 100vh;
      overflow-x: hidden;
    }

    .app-container {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .glassmorphism {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 24px;
    }

    .card-premium {
      background: var(--surface);
      backdrop-filter: blur(20px);
      border-radius: 24px;
      box-shadow: var(--shadow-elegant);
      border: 1px solid rgba(255, 255, 255, 0.3);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      overflow: hidden;
      position: relative;
    }

    .card-premium::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 2px;
      background: var(--primary-gradient);
      transition: left 0.5s ease;
    }

    .card-premium:hover::before {
      left: 0;
    }

    .card-premium:hover {
      transform: translateY(-8px);
      box-shadow: var(--shadow-hover);
    }

    .nav-header {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      padding: 1.5rem 2rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .nav-container {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo-container {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .logo-icon {
      width: 48px;
      height: 48px;
      background: var(--primary-gradient);
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      animation: float 6s ease-in-out infinite;
    }

    .brand-text {
      font-family: 'Playfair Display', serif;
      font-size: 2rem;
      font-weight: 700;
      color: white;
    }

    .nav-tabs {
      display: flex;
      gap: 0.5rem;
      background: rgba(255, 255, 255, 0.5);
      padding: 0.5rem;
      border-radius: 16px;
      backdrop-filter: blur(10px);
    }

    .nav-tab {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      border-radius: 12px;
      border: none;
      background: transparent;
      color: var(--text-secondary);
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .nav-tab::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: var(--primary-gradient);
      transition: left 0.3s ease;
      z-index: -1;
    }

    .nav-tab.active {
      background: var(--primary-gradient);
      color: white;
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
    }

    .nav-tab:hover:not(.active) {
      background: rgba(102, 126, 234, 0.1);
      color: var(--text-primary);
    }

    .logout-btn {
      background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
      color: white;
      padding: 0.75rem 1.5rem;
      border-radius: 12px;
      border: none;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .logout-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(250, 112, 154, 0.3);
    }

    .main-content {
      flex: 1;
      padding: 2rem;
      max-width: 1400px;
      margin: 0 auto;
      width: 100%;
    }

    .page-container {
      background: var(--surface);
      border-radius: 24px;
      padding: 2.5rem;
      box-shadow: var(--shadow-elegant);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      position: relative;
      overflow: hidden;
    }

    .page-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--primary-gradient);
    }

    .page-title {
      font-family: 'Playfair Display', serif;
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 1rem;
      background: var(--primary-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-align: center;
    }

    .page-subtitle {
      color: var(--text-muted);
      font-size: 1.1rem;
      text-align: center;
      margin-bottom: 3rem;
      font-weight: 400;
    }

    .form-premium {
      max-width: 400px;
      margin: 0 auto;
    }

    .input-group {
      position: relative;
      margin-bottom: 1.5rem;
    }

    .input-premium {
      width: 100%;
      padding: 1rem 1.5rem;
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.9);
      color: var(--text-primary);
      font-size: 1rem;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }

    .input-premium:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
      background: white;
    }

    .input-premium::placeholder {
      color: var(--text-muted);
    }

    .btn-premium {
      width: 100%;
      padding: 1rem 2rem;
      border: none;
      border-radius: 16px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      background: var(--primary-gradient);
      color: white;
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
    }

    .btn-premium:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 30px rgba(102, 126, 234, 0.4);
    }

    .btn-premium:active {
      transform: translateY(0);
    }

    .btn-secondary {
      background: transparent;
      color: #667eea;
      border: 2px solid #667eea;
      margin-top: 1rem;
    }

    .btn-secondary:hover {
      background: #667eea;
      color: white;
    }

    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
      margin-top: 2rem;
    }

    .feature-card {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 2rem;
      box-shadow: var(--shadow-elegant);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      position: relative;
      overflow: hidden;
    }

    .feature-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: var(--primary-gradient);
      transform: scaleX(0);
      transition: transform 0.3s ease;
    }

    .feature-card:hover::before {
      transform: scaleX(1);
    }

    .feature-card:hover {
      transform: translateY(-8px);
      box-shadow: var(--shadow-hover);
    }

    .feature-icon {
      width: 60px;
      height: 60px;
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1.5rem;
      background: var(--primary-gradient);
      color: white;
      animation: pulse-soft 2s ease-in-out infinite;
    }

    .video-container {
      position: relative;
      border-radius: 20px;
      overflow: hidden;
      background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
      box-shadow: var(--shadow-elegant);
      margin-bottom: 2rem;
    }

    .video-premium {
      width: 100%;
      border-radius: 20px;
      transform: scaleX(-1);
      background: #1e293b;
    }

    .chat-container {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      height: 500px;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      box-shadow: var(--shadow-elegant);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .chat-header {
      background: var(--primary-gradient);
      color: white;
      padding: 1rem 1.5rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .chat-messages {
      flex: 1;
      padding: 1.5rem;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 1rem;
      background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
    }

    .message-bubble {
      max-width: 75%;
      padding: 1rem 1.5rem;
      border-radius: 20px;
      font-size: 0.95rem;
      line-height: 1.5;
      position: relative;
      animation: float 0.3s ease-out;
    }

    .message-user {
      align-self: flex-end;
      background: var(--primary-gradient);
      color: white;
      border-bottom-right-radius: 8px;
    }

    .message-model {
      align-self: flex-start;
      background: white;
      color: var(--text-primary);
      border-bottom-left-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .chat-input {
      display: flex;
      padding: 1.5rem;
      gap: 1rem;
      background: white;
      align-items: center;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
    }

    .input-with-mic {
      flex: 1;
      display: flex;
      align-items: center;
      background: rgba(255, 255, 255, 0.9);
      border: 2px solid rgba(102, 126, 234, 0.2);
      border-radius: 16px;
      padding: 0.5rem;
      transition: all 0.3s ease;
    }

    .input-with-mic:focus-within {
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
    }

    .input-with-mic input {
      flex: 1;
      border: none;
      background: transparent;
      padding: 0.75rem 1rem;
      outline: none;
      font-size: 1rem;
    }

    .mic-btn {
      padding: 0.75rem;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .mic-listening {
      background: #ef4444;
      color: white;
      animation: pulse-soft 1s ease-in-out infinite;
    }

    .mic-idle {
      background: rgba(102, 126, 234, 0.1);
      color: #667eea;
    }

    .mic-idle:hover {
      background: rgba(102, 126, 234, 0.2);
    }

    .modal-premium {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      animation: float 0.3s ease-out;
    }

    .modal-content-premium {
      background: var(--surface);
      padding: 3rem;
      border-radius: 24px;
      box-shadow: 0 30px 60px rgba(0, 0, 0, 0.2);
      width: 90%;
      max-width: 500px;
      text-align: center;
      position: relative;
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      animation: float 0.4s ease-out;
    }

    .modal-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: rgba(0, 0, 0, 0.1);
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--text-muted);
      width: 3rem;
      height: 3rem;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: all 0.3s ease;
    }

    .modal-close:hover {
      background: rgba(0, 0, 0, 0.2);
      color: var(--text-primary);
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .stat-card {
      background: rgba(255, 255, 255, 0.9);
      padding: 1.5rem;
      border-radius: 16px;
      text-align: center;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      transition: all 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 25px rgba(0, 0, 0, 0.1);
    }

    .stat-number {
      font-size: 2rem;
      font-weight: 700;
      background: var(--primary-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .stat-label {
      color: var(--text-muted);
      font-size: 0.9rem;
      font-weight: 500;
      margin-top: 0.5rem;
    }

    #map {
      height: 500px;
      width: 100%;
      border-radius: 20px;
      box-shadow: var(--shadow-elegant);
      border: 1px solid rgba(255, 255, 255, 0.3);
      z-index: 1;
    }

    .message-display-premium {
      margin-top: 2rem;
      padding: 1rem 1.5rem;
      border-radius: 16px;
      text-align: center;
      font-weight: 500;
      border: 1px solid rgba(255, 255, 255, 0.3);
      backdrop-filter: blur(10px);
    }

    .success-message-premium {
      background: rgba(16, 185, 129, 0.1);
      color: #059669;
      border-color: rgba(16, 185, 129, 0.3);
    }

    .error-message-premium {
      background: rgba(239, 68, 68, 0.1);
      color: #dc2626;
      border-color: rgba(239, 68, 68, 0.3);
    }

    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .gradient-text {
      background: var(--primary-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .dashboard-container {
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      border-radius: 24px;
      padding: 2rem;
      margin: -2.5rem;
    }

    .dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 3rem;
      padding: 2rem;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 20px;
      backdrop-filter: blur(20px);
      box-shadow: var(--shadow-elegant);
    }

    .dashboard-grid {
      display: grid;
      grid-template-columns: 1fr 350px;
      gap: 2rem;
    }

    .dashboard-main {
      display: flex;
      flex-direction: column;
      gap: 2rem;
    }

    .dashboard-sidebar {
      display: flex;
      flex-direction: column;
      gap: 2rem;
    }

    .vitals-chart-container {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 2rem;
      backdrop-filter: blur(20px);
      box-shadow: var(--shadow-elegant);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .patient-card {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 2rem;
      backdrop-filter: blur(20px);
      box-shadow: var(--shadow-elegant);
      border: 1px solid rgba(255, 255, 255, 0.3);
      display: flex;
      align-items: center;
      gap: 2rem;
    }

    .patient-avatar {
      width: 80px;
      height: 80px;
      background: var(--primary-gradient);
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 2rem;
      font-weight: 700;
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
    }

    .task-item, .med-item {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 16px;
      padding: 1rem 1.5rem;
      margin-bottom: 1rem;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .task-item:hover, .med-item:hover {
      transform: translateX(8px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }

    .checkbox-premium {
      width: 24px;
      height: 24px;
      border-radius: 8px;
      border: 2px solid #e2e8f0;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .checkbox-premium.completed {
      background: var(--success-gradient);
      border-color: transparent;
    }

    .auth-container {
      max-width: 450px;
      margin: 4rem auto;
      text-align: center;
    }

    .auth-header {
      margin-bottom: 3rem;
    }

    .auth-logo {
      width: 80px;
      height: 80px;
      background: var(--primary-gradient);
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 2rem;
      animation: float 6s ease-in-out infinite;
    }

    @media (max-width: 768px) {
      .nav-tabs {
        flex-wrap: wrap;
        gap: 0.25rem;
      }
      
      .nav-tab {
        padding: 0.5rem 1rem;
        font-size: 0.9rem;
      }
      
      .dashboard-grid {
        grid-template-columns: 1fr;
      }
      
      .main-content {
        padding: 1rem;
      }
      
      .page-container {
        padding: 1.5rem;
      }
    }

    .recognition-result {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 2rem;
      margin-top: 2rem;
      backdrop-filter: blur(20px);
      box-shadow: var(--shadow-elegant);
      border: 1px solid rgba(255, 255, 255, 0.3);
      text-align: left;
    }

    .recognition-header {
      font-size: 1.3rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .recognition-item {
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .recognition-label {
      font-weight: 600;
      color: var(--text-secondary);
      min-width: 100px;
    }

    .recognition-value {
      color: var(--text-primary);
    }

    .reminder-list {
      margin-top: 2rem;
    }

    .reminder-item {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 1rem;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s ease;
    }

    .reminder-item:hover {
      transform: translateX(8px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }

    .btn-add {
      background: var(--success-gradient);
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn-add:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(79, 172, 254, 0.3);
    }

    .floating-action-btn {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      width: 60px;
      height: 60px;
      background: var(--primary-gradient);
      border: none;
      border-radius: 50%;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 50;
    }

    .floating-action-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 12px 30px rgba(102, 126, 234, 0.5);
    }

    .badge-premium {
      padding: 0.5rem 1rem;
      border-radius: 12px;
      font-size: 0.85rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .badge-primary {
      background: rgba(102, 126, 234, 0.1);
      color: #667eea;
    }

    .badge-success {
      background: rgba(16, 185, 129, 0.1);
      color: #059669;
    }

    .badge-warning {
      background: rgba(245, 158, 11, 0.1);
      color: #d97706;
    }

    .badge-danger {
      background: rgba(239, 68, 68, 0.1);
      color: #dc2626;
    }

    .speaker-btn {
      background: transparent;
      border: none;
      padding: 0.5rem;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .speaker-btn:hover {
      background: rgba(102, 126, 234, 0.1);
    }

    .delete-btn {
      background: transparent;
      border: none;
      color: #ef4444;
      padding: 0.5rem;
      border-radius: 8px;
      cursor: pointer;
      opacity: 0;
      transition: all 0.3s ease;
    }

    .med-item:hover .delete-btn,
    .task-item:hover .delete-btn {
      opacity: 1;
    }

    .delete-btn:hover {
      background: rgba(239, 68, 68, 0.1);
    }

    .leaflet-control-container .leaflet-routing-container-hide {
      display: none;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(102, 126, 234, 0.3);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(102, 126, 234, 0.5);
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel" data-type="module">
    const { useState, useEffect, useRef } = React;
    const API_URL = 'http://localhost:3000';
    
    // Enhanced SVG Icons with premium styling
    const ScanIcon = () => (
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
        <path d="M3 7V5a2 2 0 0 1 2-2h2"/>
        <path d="M17 3h2a2 2 0 0 1 2 2v2"/>
        <path d="M21 17v2a2 2 0 0 1-2 2h-2"/>
        <path d="M7 21H5a2 2 0 0 1-2-2v-2"/>
        <rect x="7" y="7" width="10" height="10" rx="2"/>
        <path d="M12 7v10"/>
      </svg>
    );
    
    const ChatIcon = () => (
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
        <path d="M9 9h6"/>
        <path d="M9 13h4"/>
      </svg>
    );
    
    const ReminderIcon = () => (
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
        <circle cx="12" cy="12" r="10"/>
        <polyline points="12,6 12,12 16,14"/>
      </svg>
    );
    
    const DashboardIcon = () => (
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
        <rect x="3" y="3" width="7" height="7" rx="1"/>
        <rect x="14" y="3" width="7" height="7" rx="1"/>
        <rect x="14" y="14" width="7" height="7" rx="1"/>
        <rect x="3" y="14" width="7" height="7" rx="1"/>
      </svg>
    );
    
    const LogoutIcon = () => (
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
        <polyline points="16,17 21,12 16,7"/>
        <line x1="21" y1="12" x2="9" y2="12"/>
      </svg>
    );
    
    const CheckIcon = () => (
      <svg className="w-4 h-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="20,6 9,17 4,12"/>
      </svg>
    );
    
    const MicrophoneIcon = () => (
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
        <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
        <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
        <line x1="12" y1="19" x2="12" y2="23"/>
        <line x1="8" y1="23" x2="16" y2="23"/>
      </svg>
    );
    
    const SpeakerIcon = ({isSpeaking}) => (
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" className={isSpeaking ? 'animate-pulse' : ''}>
        <polygon points="11,5 6,9 2,9 2,15 6,15 11,19 11,5"/>
        <path d="M19.07 4.93a10 10 0 0 1 0 14.14"/>
        <path d="M15.54 8.46a5 5 0 0 1 0 7.07"/>
      </svg>
    );

    const NavigationIcon = () => (
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
        <polygon points="3,11 22,2 13,21 11,13 3,11"/>
      </svg>
    );
    
    const DeleteIcon = () => (
      <svg width="18" height="18" viewBox="0 0 20 20" fill="currentColor">
        <path fillRule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z" clipRule="evenodd"/>
      </svg>
    );

    const PlusIcon = () => (
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
        <line x1="12" y1="5" x2="12" y2="19"/>
        <line x1="5" y1="12" x2="19" y2="12"/>
      </svg>
    );

    const SuccessIcon = () => (
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
        <polyline points="22,4 12,14.01 9,11.01"/>
      </svg>
    );

    // Firebase imports
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, doc, setDoc, getDoc, collection, addDoc, onSnapshot, query, updateDoc, deleteDoc, Timestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-caregiver-app';
    const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_AUTH_DOMAIN",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_STORAGE_BUCKET",
      messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
      appId: "YOUR_APP_ID"
    };
    const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

    // Enhanced Modal Component
    const ModalPremium = ({ isOpen, onClose, children, title }) => {
        if (!isOpen) return null;
        return (
          <div className="modal-premium">
            <div className="modal-content-premium">
              <button onClick={onClose} className="modal-close">&times;</button>
              {title && <h3 className="text-2xl font-bold gradient-text mb-6">{title}</h3>}
              {children}
            </div>
          </div>
        );
    };

    // Enhanced Vitals Chart Component
    const VitalsChart = ({ vitalsData }) => {
        const getPathData = (data, key, color, maxVal) => {
          if (!data || data.length < 2) return { path: "", points: [] };
          const width = 400, height = 150, padding = 30;
          const maxX = data.length - 1;
          const points = data.map((item, i) => {
            const x = (width - padding * 2) * (i / maxX) + padding;
            const y = height - padding - ((height - padding * 2) * (item[key] / maxVal));
            return {
              x, y, value: item[key],
              timestamp: new Date(item.timestamp?.seconds * 1000).toLocaleTimeString()
            };
          });
          const path = points.map((p, i) => i === 0 ? `M ${p.x} ${p.y}` : `L ${p.x} ${p.y}`).join(" ");
          return { path, points, color };
        };

        const heartRateData = getPathData(vitalsData, 'heartRate', '#f093fb', 150);
        const bpData = getPathData(vitalsData, 'bloodPressure', '#667eea', 200);

        return (
          <div className="vitals-chart-container">
            <div className="flex justify-between items-center mb-6">
              <h3 className="text-xl font-semibold gradient-text">Vitals Monitoring</h3>
              <div className="flex gap-4 text-sm">
                <div className="flex items-center gap-2">
                  <div className="w-3 h-3 rounded-full" style={{background: '#f093fb'}}></div>
                  <span>Heart Rate</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="w-3 h-3 rounded-full" style={{background: '#667eea'}}></div>
                  <span>Blood Pressure</span>
                </div>
              </div>
            </div>
            <svg viewBox="0 0 400 180" className="w-full h-auto">
              <defs>
                <linearGradient id="hrGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style={{stopColor: '#f093fb', stopOpacity: 0.3}} />
                  <stop offset="100%" style={{stopColor: '#f093fb', stopOpacity: 0}} />
                </linearGradient>
                <linearGradient id="bpGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style={{stopColor: '#667eea', stopOpacity: 0.3}} />
                  <stop offset="100%" style={{stopColor: '#667eea', stopOpacity: 0}} />
                </linearGradient>
                <filter id="glow">
                  <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                  <feMerge> 
                    <feMergeNode in="coloredBlur"/>
                    <feMergeNode in="SourceGraphic"/>
                  </feMerge>
                </filter>
              </defs>
              <text x="10" y="25" fontSize="12" fill="#94a3b8" fontWeight="500">150</text>
              <text x="10" y="140" fontSize="12" fill="#94a3b8" fontWeight="500">0</text>
              <line x1="30" y1="30" x2="370" y2="30" stroke="rgba(148, 163, 184, 0.3)" strokeWidth="1" strokeDasharray="4,4" />
              <line x1="30" y1="140" x2="370" y2="140" stroke="rgba(148, 163, 184, 0.3)" strokeWidth="1" />
              <path d={heartRateData.path} stroke={heartRateData.color} fill="none" strokeWidth="3" filter="url(#glow)" />
              <path d={bpData.path} stroke={bpData.color} fill="none" strokeWidth="3" filter="url(#glow)" />
              {vitalsData.length > 1 && <path d={`${heartRateData.path} L 370 140 L 30 140 Z`} fill="url(#hrGradient)" />}
              {vitalsData.length > 1 && <path d={`${bpData.path} L 370 140 L 30 140 Z`} fill="url(#bpGradient)" />}
              {heartRateData.points.map((p, i) => (
                <g key={`hr-${i}`} className="group cursor-pointer">
                  <circle cx={p.x} cy={p.y} r="12" fill={heartRateData.color} fillOpacity="0" className="transition-all group-hover:fill-opacity-20" />
                  <circle cx={p.x} cy={p.y} r="5" fill={heartRateData.color} className="transition-all group-hover:r-6"/>
                  <title>{`Heart Rate: ${p.value} bpm at ${p.timestamp}`}</title>
                </g>
              ))}
              {bpData.points.map((p, i) => (
                <g key={`bp-${i}`} className="group cursor-pointer">
                  <circle cx={p.x} cy={p.y} r="12" fill={bpData.color} fillOpacity="0" className="transition-all group-hover:fill-opacity-20" />
                  <circle cx={p.x} cy={p.y} r="5" fill={bpData.color} className="transition-all group-hover:r-6"/>
                  <title>{`Blood Pressure: ${p.value} mmHg at ${p.timestamp}`}</title>
                </g>
              ))}
            </svg>
          </div>
        );
    };

    // Enhanced Caregiver Dashboard
    function CaregiverDashboardPage() {
        const [auth, setAuth] = useState(null);
        const [db, setDb] = useState(null);
        const [userId, setUserId] = useState(null);
        const [patient, setPatient] = useState({ name: 'Jane Doe', age: 72, condition: 'Post-operative Care' });
        const [tasks, setTasks] = useState([]);
        const [medications, setMedications] = useState([]);
        const [vitals, setVitals] = useState([]);
        const [isTaskModalOpen, setTaskModalOpen] = useState(false);
        const [newTask, setNewTask] = useState('');
        const [isMedModalOpen, setMedModalOpen] = useState(false);
        const [newMed, setNewMed] = useState({ name: '', dosage: '', time: '' });
        const [isVitalsModalOpen, setVitalsModalOpen] = useState(false);
        const [newVitals, setNewVitals] = useState({ heartRate: '', bloodPressure: '' });

        useEffect(() => {
          const app = initializeApp(firebaseConfig);
          const authInstance = getAuth(app);
          const dbInstance = getFirestore(app);
          setAuth(authInstance);
          setDb(dbInstance);
          const unsub = onAuthStateChanged(authInstance, async (user) => {
            if (user) setUserId(user.uid);
            else {
              try {
                if (initialAuthToken) await signInWithCustomToken(authInstance, initialAuthToken);
                else await signInAnonymously(authInstance);
              } catch (e) {
                console.error("Sign in failed:", e);
              }
            }
          });
          return unsub;
        }, []);

        useEffect(() => {
          if (db && userId) {
            const unsubPatient = onSnapshot(doc(db, `artifacts/${appId}/users/${userId}/patient/profile`), (docSnap) => {
              if (docSnap.exists()) setPatient(docSnap.data());
              else setDoc(doc(db, `artifacts/${appId}/users/${userId}/patient/profile`), patient);
            });
            const unsubTasks = onSnapshot(query(collection(db, `artifacts/${appId}/users/${userId}/tasks`)), (s) => setTasks(s.docs.map(d => ({ id: d.id, ...d.data() }))));
            const unsubMeds = onSnapshot(query(collection(db, `artifacts/${appId}/users/${userId}/medications`)), (s) => setMedications(s.docs.map(d => ({ id: d.id, ...d.data() }))));
            const unsubVitals = onSnapshot(query(collection(db, `artifacts/${appId}/users/${userId}/vitals`)), (s) => setVitals(s.docs.map(d => ({ id: d.id, ...d.data() })).sort((a,b) => a.timestamp.seconds - b.timestamp.seconds)));
            return () => { unsubPatient(); unsubTasks(); unsubMeds(); unsubVitals(); };
          }
        }, [db, userId]);

        const handleAddTask = async (e) => {
          e.preventDefault();
          if (!newTask.trim() || !db || !userId) return;
          await addDoc(collection(db, `artifacts/${appId}/users/${userId}/tasks`), {
            text: newTask,
            completed: false,
            createdAt: Timestamp.now()
          });
          setNewTask('');
          setTaskModalOpen(false);
        };

        const handleToggleTask = async (task) => {
          if (db && userId) await updateDoc(doc(db, `artifacts/${appId}/users/${userId}/tasks`, task.id), { completed: !task.completed });
        };

        const handleAddMedication = async (e) => {
          e.preventDefault();
          if (!newMed.name || !newMed.dosage || !newMed.time || !db || !userId) return;
          await addDoc(collection(db, `artifacts/${appId}/users/${userId}/medications`), {
            ...newMed,
            createdAt: Timestamp.now()
          });
          setNewMed({ name: '', dosage: '', time: '' });
          setMedModalOpen(false);
        };

        const handleAddVitals = async (e) => {
          e.preventDefault();
          const hr = parseInt(newVitals.heartRate, 10), bp = parseInt(newVitals.bloodPressure, 10);
          if (hr > 0 && bp > 0 && db && userId) {
            await addDoc(collection(db, `artifacts/${appId}/users/${userId}/vitals`), {
              heartRate: hr,
              bloodPressure: bp,
              timestamp: Timestamp.now()
            });
            setNewVitals({ heartRate: '', bloodPressure: ''});
            setVitalsModalOpen(false);
          }
        };

        const handleDeleteMedication = async (medId) => {
          if (db && userId) await deleteDoc(doc(db, `artifacts/${appId}/users/${userId}/medications`, medId));
        };

        return (
          <div className="dashboard-container">
            <div className="dashboard-header">
              <div>
                <h1 className="text-4xl font-bold gradient-text mb-2">Care Dashboard</h1>
                <p className="text-lg text-slate-600">Real-time patient monitoring and care management</p>
              </div>
              <div className="flex items-center gap-3 text-sm">
                <span className="badge-premium badge-primary">Live Session</span>
                <span className="text-slate-500">ID: {userId ? userId.slice(-8) : 'Loading...'}</span>
              </div>
            </div>

            <div className="dashboard-grid">
              <div className="dashboard-main">
                <div className="patient-card">
                  <div className="patient-avatar">
                    {patient.name.charAt(0)}
                  </div>
                  <div className="text-left">
                    <h2 className="text-2xl font-bold text-slate-800 mb-1">{patient.name}</h2>
                    <p className="text-slate-600 mb-2">Age: {patient.age} years</p>
                    <span className="badge-premium badge-primary">{patient.condition}</span>
                  </div>
                </div>

                <VitalsChart vitalsData={vitals} />
              </div>

              <div className="dashboard-sidebar">
                <div className="card-premium p-6">
                  <div className="flex justify-between items-center mb-6">
                    <h3 className="text-xl font-semibold gradient-text">Daily Tasks</h3>
                    <button onClick={() => setTaskModalOpen(true)} className="btn-add">
                      <PlusIcon />
                      Add Task
                    </button>
                  </div>
                  <div className="space-y-3">
                    {tasks.map((task) => (
                      <div key={task.id} onClick={() => handleToggleTask(task)} className={`task-item cursor-pointer ${task.completed ? 'opacity-60' : ''}`}>
                        <div className={`checkbox-premium ${task.completed ? 'completed' : ''}`}>
                          {task.completed && <CheckIcon />}
                        </div>
                        <span className={task.completed ? 'line-through text-slate-500' : 'text-slate-800'}>{task.text}</span>
                      </div>
                    ))}
                    {tasks.length === 0 && (
                      <div className="text-center py-8 text-slate-500">
                        <p>No tasks for today</p>
                        <p className="text-sm">All caught up!</p>
                      </div>
                    )}
                  </div>
                </div>

                <div className="card-premium p-6">
                  <div className="flex justify-between items-center mb-6">
                    <h3 className="text-xl font-semibold gradient-text">Medications</h3>
                    <button onClick={() => setMedModalOpen(true)} className="btn-add">
                      <PlusIcon />
                      Add Med
                    </button>
                  </div>
                  <div className="space-y-3">
                    {medications.map(med => (
                      <div key={med.id} className="med-item group">
                        <div className="flex-1">
                          <p className="font-semibold text-slate-800">{med.name}</p>
                          <p className="text-sm text-slate-600">{med.dosage}</p>
                        </div>
                        <div className="flex items-center gap-3">
                          <span className="badge-premium badge-warning">{med.time}</span>
                          <button onClick={() => handleDeleteMedication(med.id)} className="delete-btn">
                            <DeleteIcon />
                          </button>
                        </div>
                      </div>
                    ))}
                    {medications.length === 0 && (
                      <div className="text-center py-8 text-slate-500">
                        <p>No medications scheduled</p>
                      </div>
                    )}
                  </div>
                </div>
              </div>
            </div>

            <ModalPremium isOpen={isTaskModalOpen} onClose={() => setTaskModalOpen(false)} title="Add New Task">
              <form onSubmit={handleAddTask} className="form-premium">
                <div className="input-group">
                  <input 
                    type="text" 
                    value={newTask} 
                    onChange={(e) => setNewTask(e.target.value)} 
                    placeholder="e.g., Check blood pressure"
                    className="input-premium"
                  />
                </div>
                <button type="submit" className="btn-premium">Add Task</button>
              </form>
            </ModalPremium>

            <ModalPremium isOpen={isMedModalOpen} onClose={() => setMedModalOpen(false)} title="Add New Medication">
              <form onSubmit={handleAddMedication} className="form-premium">
                <div className="input-group">
                  <input 
                    type="text" 
                    value={newMed.name} 
                    onChange={(e) => setNewMed({...newMed, name: e.target.value})} 
                    placeholder="Medication Name"
                    className="input-premium"
                  />
                </div>
                <div className="input-group">
                  <input 
                    type="text" 
                    value={newMed.dosage} 
                    onChange={(e) => setNewMed({...newMed, dosage: e.target.value})} 
                    placeholder="Dosage (e.g., 500mg)"
                    className="input-premium"
                  />
                </div>
                <div className="input-group">
                  <input 
                    type="time" 
                    value={newMed.time} 
                    onChange={(e) => setNewMed({...newMed, time: e.target.value})}
                    className="input-premium"
                  />
                </div>
                <button type="submit" className="btn-premium">Add Medication</button>
              </form>
            </ModalPremium>

            <ModalPremium isOpen={isVitalsModalOpen} onClose={() => setVitalsModalOpen(false)} title="Add Vitals Reading">
              <form onSubmit={handleAddVitals} className="form-premium">
                <div className="input-group">
                  <input 
                    type="number" 
                    value={newVitals.heartRate} 
                    onChange={(e) => setNewVitals({...newVitals, heartRate: e.target.value})} 
                    placeholder="Heart Rate (bpm)"
                    className="input-premium"
                  />
                </div>
                <div className="input-group">
                  <input 
                    type="number" 
                    value={newVitals.bloodPressure} 
                    onChange={(e) => setNewVitals({...newVitals, bloodPressure: e.target.value})} 
                    placeholder="Blood Pressure (systolic)"
                    className="input-premium"
                  />
                </div>
                <button type="submit" className="btn-premium">Add Reading</button>
              </form>
            </ModalPremium>
          </div>
        );
    }

    // Enhanced Auth Page
    const AuthPage = ({ setToken, email, setEmail, password, setPassword, loading, setLoading, message, setMessage }) => {
        const [isLogin, setIsLogin] = useState(true);
        const [name, setName] = useState('');

        const handleRegister = async (e) => {
          e.preventDefault();
          setLoading(true);
          setMessage('');
          try {
            await axios.post(`${API_URL}/auth/register`, { name, email, password });
            setMessage('Registration successful! Please log in.');
            setIsLogin(true);
          } catch (error) {
            setMessage(`Error: ${error?.response?.data?.message || error.message}`);
          } finally {
            setLoading(false);
          }
        };

        const handleLogin = async (e) => {
          e.preventDefault();
          setLoading(true);
          setMessage('');
          try {
            const response = await axios.post(`${API_URL}/auth/login`, { email, password });
            setToken(response.data.token);
          } catch (error) {
            setMessage(`Error: ${error?.response?.data?.message || error.message}`);
          } finally {
            setLoading(false);
          }
        };

        return (
          <div className="auth-container">
            <div className="auth-header">
              <div className="auth-logo">
                <svg width="40" height="40" viewBox="0 0 32 32" fill="none">
                  <path d="M16 2.66663C8.636 2.66663 2.66669 8.63596 2.66669 16C2.66669 23.364 8.636 29.3333 16 29.3333C23.364 29.3333 29.3334 23.364 29.3334 16C29.3334 8.63596 23.364 2.66663 16 2.66663ZM20 17.3333H17.3334V20C17.3334 20.7363 16.736 21.3333 16 21.3333C15.264 21.3333 14.6667 20.7363 14.6667 20V17.3333H12C11.264 17.3333 10.6667 16.7363 10.6667 16C10.6667 15.2636 11.264 14.6666 12 14.6666H14.6667V12C14.6667 11.2636 15.264 10.6666 16 10.6666C16.736 10.6666 17.3334 11.2636 17.3334 12V14.6666H20C20.736 14.6666 21.3334 15.2636 21.3334 16C21.3334 16.7363 20.736 17.3333 20 17.3333Z" fill="white"/>
                </svg>
              </div>
              <h1 className="brand-text mb-2">MediSort</h1>
              <p className="text-slate-600 text-lg">Welcome to the future of healthcare management</p>
            </div>

            <div className="card-premium p-8">
              <div className="flex justify-center mb-6">
                <div className="nav-tabs">
                  <button 
                    className={`nav-tab ${isLogin ? 'active' : ''}`}
                    onClick={() => setIsLogin(true)}
                  >
                    Sign In
                  </button>
                  <button 
                    className={`nav-tab ${!isLogin ? 'active' : ''}`}
                    onClick={() => setIsLogin(false)}
                  >
                    Sign Up
                  </button>
                </div>
              </div>

              <form onSubmit={isLogin ? handleLogin : handleRegister} className="form-premium">
                {!isLogin && (
                  <div className="input-group">
                    <input 
                      type="text" 
                      placeholder="Full Name" 
                      value={name} 
                      onChange={(e) => setName(e.target.value)} 
                      className="input-premium"
                      required 
                    />
                  </div>
                )}
                <div className="input-group">
                  <input 
                    type="email" 
                    placeholder="Email Address" 
                    value={email} 
                    onChange={(e) => setEmail(e.target.value)} 
                    className="input-premium"
                    required 
                  />
                </div>
                <div className="input-group">
                  <input 
                    type="password" 
                    placeholder="Password" 
                    value={password} 
                    onChange={(e) => setPassword(e.target.value)} 
                    className="input-premium"
                    required 
                  />
                </div>
                <button type="submit" disabled={loading} className="btn-premium">
                  {loading ? (
                    <div className="flex items-center justify-center gap-2">
                      <div className="loading-spinner"></div>
                      {isLogin ? 'Signing In...' : 'Creating Account...'}
                    </div>
                  ) : (
                    isLogin ? 'Sign In' : 'Create Account'
                  )}
                </button>
              </form>
            </div>
          </div>
        );
    };

    // Enhanced Scan Page
    const ScanPage = ({ token, loading, setLoading, message, setMessage }) => {
        const videoRef = useRef(null);
        const canvasRef = useRef(null);
        const [recognitionResult, setRecognitionResult] = useState(null);
        const [selectedFile, setSelectedFile] = useState(null);

        const handleFileSelect = (event) => {
          setSelectedFile(event.target.files[0]);
          setMessage('File selected. Click "Analyze" to recognize.');
        };

        const handleUpload = async () => {
          setLoading(true);
          setMessage('Analyzing medication...');
          setRecognitionResult(null);
          const formData = new FormData();
          if (selectedFile) {
            formData.append('image', selectedFile, selectedFile.name);
          } else {
            const video = videoRef.current;
            if (!video || !video.videoWidth) {
              setMessage('Error: Camera not ready.');
              setLoading(false);
              return;
            }
            const canvas = canvasRef.current;
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            const context = canvas.getContext('2d');
            context.drawImage(video, 0, 0, canvas.width, canvas.height);
            const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/jpeg'));
            formData.append('image', blob, 'scan.jpg');
          }
          try {
            const response = await axios.post(`${API_URL}/scan`, formData, {
              headers: {
                'Content-Type': 'multipart/form-data',
                'Authorization': `Bearer ${token}`
              }
            });
            setMessage('Recognition successful!');
            setRecognitionResult(response.data.recognition);
          } catch (error) {
            setMessage(`Error: ${error?.response?.data?.message || 'Upload failed'}`);
          } finally {
            setLoading(false);
            setSelectedFile(null);
          }
        };

        useEffect(() => {
          const startCamera = async () => {
            try {
              const stream = await navigator.mediaDevices.getUserMedia({
                video: { facingMode: 'environment' }
              });
              if (videoRef.current) {
                videoRef.current.srcObject = stream;
              }
            } catch (error) {
              setMessage('Error: Cannot access camera.');
            }
          };
          startCamera();
          return () => {
            if (videoRef.current && videoRef.current.srcObject) {
              videoRef.current.srcObject.getTracks().forEach(track => track.stop());
            }
          };
        }, []);

        return (
          <div className="page-container">
            <h1 className="page-title">Smart Medication Scanner</h1>
            <p className="page-subtitle">Upload an image or use live camera to identify medications instantly</p>

            <div className="form-premium">
              <div className="input-group">
                <input 
                  type="file" 
                  accept="image/*" 
                  onChange={handleFileSelect} 
                  className="input-premium"
                />
              </div>

              <div className="video-container">
                <video ref={videoRef} className="video-premium" autoPlay playsInline></video>
                <canvas ref={canvasRef} style={{ display: 'none' }}></canvas>
              </div>

              <button onClick={handleUpload} disabled={loading} className="btn-premium">
                {loading ? (
                  <div className="flex items-center justify-center gap-2">
                    <div className="loading-spinner"></div>
                    Analyzing...
                  </div>
                ) : (
                  selectedFile ? 'Analyze Selected Image' : 'Capture & Analyze'
                )}
              </button>

              {recognitionResult && (
                <div className="recognition-result">
                  <div className="recognition-header">
                    <SuccessIcon />
                    Recognition Results
                  </div>
                  <div className="recognition-item">
                    <span className="recognition-label">Medication:</span>
                    <span className="recognition-value font-semibold">{recognitionResult.name}</span>
                  </div>
                  <div className="recognition-item">
                    <span className="recognition-label">Confidence:</span>
                    <span className="recognition-value">{Math.round(recognitionResult.confidence * 100)}%</span>
                  </div>
                  <div className="recognition-item">
                    <span className="recognition-label">Advice:</span>
                    <span className="recognition-value">{recognitionResult.advice}</span>
                  </div>
                </div>
              )}
            </div>
          </div>
        );
    };

    // Enhanced Chatbot Page
    const ChatbotPage = ({ token, loading, setLoading, message, setMessage }) => {
        const [userInput, setUserInput] = useState('');
        const [chatHistory, setChatHistory] = useState([
            { role: 'model', content: 'Hello! I\'m your AI healthcare assistant. How can I help you with your medication questions today?', id: Date.now() }
        ]);
        const [isListening, setIsListening] = useState(false);
        const [speakingMessageId, setSpeakingMessageId] = useState(null);
        const chatContainerRef = useRef(null);
        const recognitionRef = useRef(null);

        useEffect(() => {
            if (chatContainerRef.current) {
                chatContainerRef.current.scrollTop = chatContainerRef.current.scrollHeight;
            }
        }, [chatHistory]);

        const speakText = (text, messageId) => {
            if (speakingMessageId === messageId) {
                window.speechSynthesis.cancel();
                setSpeakingMessageId(null);
                return;
            }
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.onstart = () => setSpeakingMessageId(messageId);
            utterance.onend = () => setSpeakingMessageId(null);
            utterance.onerror = () => setSpeakingMessageId(null);
            window.speechSynthesis.cancel();
            window.speechSynthesis.speak(utterance);
        };

        const handleListen = () => {
            if (isListening) {
                recognitionRef.current.stop();
                setIsListening(false);
                return;
            }
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (!SpeechRecognition) {
                alert("Sorry, your browser doesn't support speech recognition.");
                return;
            }

            const recognition = new SpeechRecognition();
            recognitionRef.current = recognition;
            recognition.continuous = false;
            recognition.interimResults = true;
            recognition.lang = 'en-US';
            recognition.onstart = () => setIsListening(true);
            recognition.onend = () => setIsListening(false);
            recognition.onerror = (event) => {
                console.error("Speech recognition error", event.error);
                setIsListening(false);
            };
            recognition.onresult = (event) => {
                const transcript = Array.from(event.results)
                    .map(result => result[0])
                    .map(result => result.transcript)
                    .join('');
                setUserInput(transcript);
                if (event.results[0].isFinal) {
                    handleSendMessage(null, transcript);
                }
            };
            recognition.start();
        };

        const handleSendMessage = async (e, text = userInput) => {
            if (e) e.preventDefault();
            if (!text.trim()) return;
            const newUserMessage = { role: 'user', content: text, id: Date.now() };
            setChatHistory(prev => [...prev, newUserMessage]);
            setUserInput('');
            setLoading(true);

            try {
                const response = await axios.post(`${API_URL}/rag/ask`,
                    { question: text },
                    { headers: { 'Authorization': `Bearer ${token}` } }
                );
                const modelMessage = { role: 'model', content: response.data.answer, id: Date.now() + 1 };
                setChatHistory(prev => [...prev, modelMessage]);
            } catch (error) {
                const errorMessage = { role: 'model', content: 'Sorry, an error occurred. Please try again.', id: Date.now() + 1 };
                setChatHistory(prev => [...prev, errorMessage]);
            } finally {
                setLoading(false);
            }
        };

        return (
          <div className="page-container">
            <h1 className="page-title">AI Healthcare Assistant</h1>
            <p className="page-subtitle">Get instant answers about medications, dosages, and health concerns</p>

            <div className="chat-container">
              <div className="chat-header">
                <ChatIcon />
                Healthcare AI Assistant
              </div>
              
              <div ref={chatContainerRef} className="chat-messages">
                {chatHistory.map((msg) => (
                  <div key={msg.id} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'} items-end gap-2`}>
                    {msg.role === 'model' && (
                      <button onClick={() => speakText(msg.content, msg.id)} className="speaker-btn mb-1">
                        <SpeakerIcon isSpeaking={speakingMessageId === msg.id} />
                      </button>
                    )}
                    <div className={`message-bubble ${msg.role === 'user' ? 'message-user' : 'message-model'}`}>
                      {msg.content}
                    </div>
                  </div>
                ))}
                {loading && (
                  <div className="flex justify-start">
                    <div className="message-bubble message-model">
                      <div className="flex items-center gap-2">
                        <div className="loading-spinner"></div>
                        AI is thinking...
                      </div>
                    </div>
                  </div>
                )}
              </div>

              <div className="chat-input">
                <button 
                  type="button" 
                  onClick={handleListen} 
                  className={`mic-btn ${isListening ? 'mic-listening' : 'mic-idle'}`}
                >
                  <MicrophoneIcon />
                </button>
                <div className="input-with-mic">
                  <input
                    type="text"
                    placeholder={isListening ? 'Listening...' : "Ask about medications..."}
                    value={userInput}
                    onChange={(e) => setUserInput(e.target.value)}
                    disabled={loading}
                  />
                </div>
                <button 
                  onClick={handleSendMessage} 
                  disabled={loading || !userInput.trim()} 
                  className="btn-premium !w-auto px-6"
                >
                  Send
                </button>
              </div>
            </div>
          </div>
        );
    };

    // Enhanced Navigation Page
    const NavigationPage = ({ token, loading, setLoading, message, setMessage }) => {
        const mapRef = useRef(null);
        const mapInstanceRef = useRef(null);
        const [userLocation, setUserLocation] = useState(null);
        const [nearestLocation, setNearestLocation] = useState(null);

        const locations = [
            { name: "Manipal Hospital", coords: [12.9822, 77.6070], type: "hospital" },
            { name: "Fortis Clinic", coords: [12.9500, 77.6000], type: "clinic" },
            { name: "CloudNine Hospital", coords: [12.9600, 77.5800], type: "hospital" },
            { name: "Narayana Health", coords: [12.9100, 77.6100], type: "hospital" },
            { name: "BGS Gleneagles", coords: [12.9200, 77.5900], type: "hospital" }
        ];

        const getDistance = (lat1, lon1, lat2, lon2) => {
            const R = 6371;
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = 
                0.5 - Math.cos(dLat)/2 + 
                Math.cos(lat1 * Math.PI/180) * Math.cos(lat2 * Math.PI/180) * 
                (1 - Math.cos(dLon))/2;
            return R * 2 * Math.asin(Math.sqrt(a));
        };

        useEffect(() => {
            if (mapRef.current && !mapInstanceRef.current) {
                const map = L.map(mapRef.current).setView([12.9716, 77.5946], 13);
                mapInstanceRef.current = map;

                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: ' OpenStreetMap contributors'
                }).addTo(map);

                locations.forEach((loc) => {
                    L.marker(loc.coords)
                     .addTo(map)
                     .bindPopup(`<b>${loc.name}</b><br>Type: ${loc.type.charAt(0).toUpperCase() + loc.type.slice(1)}`);
                });

                map.on('locationfound', (e) => {
                    const userCoords = e.latlng;
                    setUserLocation(userCoords);

                    L.marker(userCoords)
                     .addTo(map)
                     .bindPopup("You are here")
                     .openPopup();

                    let nearest = null;
                    let minDist = Infinity;
                    locations.forEach((loc) => {
                        const dist = getDistance(userCoords.lat, userCoords.lng, loc.coords[0], loc.coords[1]);
                        if (dist < minDist) {
                            minDist = dist;
                            nearest = { ...loc, distance: dist };
                        }
                    });

                    setNearestLocation(nearest);
                    setMessage(`Nearest location: ${nearest.name} (${minDist.toFixed(2)} km away)`);

                    if (window.L.Routing) {
                        L.Routing.control({
                            waypoints: [
                                L.latLng(userCoords.lat, userCoords.lng),
                                L.latLng(nearest.coords[0], nearest.coords[1])
                            ],
                            routeWhileDragging: false,
                            addWaypoints: false,
                            createMarker: () => null
                        }).addTo(map);
                    }
                });

                map.on('locationerror', (e) => {
                    setMessage('Location access denied. Please enable GPS to find nearby locations.');
                });
            }
        }, []);

        const handleLocateUser = () => {
            if (mapInstanceRef.current) {
                setLoading(true);
                setMessage('Getting your location...');
                mapInstanceRef.current.locate({ setView: true, maxZoom: 16 });
                setTimeout(() => setLoading(false), 2000);
            }
        };

        const handleNavigateToLocation = (location) => {
            if (mapInstanceRef.current && userLocation) {
                mapInstanceRef.current.eachLayer((layer) => {
                    if (layer instanceof L.Routing.Control) {
                        mapInstanceRef.current.removeControl(layer);
                    }
                });

                if (window.L.Routing) {
                    L.Routing.control({
                        waypoints: [
                            L.latLng(userLocation.lat, userLocation.lng),
                            L.latLng(location.coords[0], location.coords[1])
                        ],
                        routeWhileDragging: false,
                        addWaypoints: false,
                        createMarker: () => null
                    }).addTo(mapInstanceRef.current);
                }

                setMessage(`Navigation started to ${location.name}`);
            } else {
                setMessage('Please locate yourself first before navigation.');
            }
        };

        return (
          <div className="page-container">
            <h1 className="page-title">Smart Navigation</h1>
            <p className="page-subtitle">Find and navigate to nearby healthcare facilities with real-time directions</p>

            <div className="form-premium !max-w-6xl">
              <div className="mb-6 flex justify-center">
                <button 
                  onClick={handleLocateUser} 
                  disabled={loading} 
                  className="btn-premium !w-auto px-8"
                >
                  {loading ? (
                    <div className="flex items-center gap-2">
                      <div className="loading-spinner"></div>
                      Locating...
                    </div>
                  ) : (
                    <>
                      <NavigationIcon />
                      Find My Location
                    </>
                  )}
                </button>
              </div>

              <div ref={mapRef} id="map" className="mb-6"></div>

              {nearestLocation && (
                <div className="card-premium p-6 mb-6">
                  <h3 className="text-xl font-semibold gradient-text mb-4">Nearest Healthcare Facility</h3>
                  <div className="flex justify-between items-center">
                    <div>
                      <p className="font-semibold text-lg text-slate-800">{nearestLocation.name}</p>
                      <p className="text-slate-600">
                        {nearestLocation.type.charAt(0).toUpperCase() + nearestLocation.type.slice(1)}  
                        {nearestLocation.distance.toFixed(2)} km away
                      </p>
                    </div>
                    <button 
                      onClick={() => handleNavigateToLocation(nearestLocation)}
                      className="btn-premium !w-auto px-6"
                    >
                      Start Navigation
                    </button>
                  </div>
                </div>
              )}

              <div className="card-premium overflow-hidden">
                <div className="p-6 bg-gradient-to-r from-slate-50 to-white border-b border-slate-200">
                  <h3 className="text-xl font-semibold gradient-text">All Healthcare Locations</h3>
                </div>
                <div className="divide-y divide-slate-100">
                  {locations.map((location, index) => (
                    <div key={index} className="p-6 flex justify-between items-center hover:bg-slate-50 transition-colors">
                      <div>
                        <p className="font-semibold text-slate-800 text-lg">{location.name}</p>
                        <p className="text-slate-600 capitalize">{location.type}</p>
                      </div>
                      <button 
                        onClick={() => handleNavigateToLocation(location)}
                        disabled={!userLocation}
                        className={`btn-premium !w-auto px-6 ${!userLocation ? 'opacity-50 cursor-not-allowed' : ''}`}
                      >
                        Navigate
                      </button>
                    </div>
                  ))}
                </div>
              </div>
            </div>
          </div>
        );
    };

    // Enhanced Reminders Page
    const ReminderModal = ({ reminder, onClose, loading }) => (
      <div className="modal-premium">
        <div className="modal-content-premium">
          <button className="modal-close" onClick={onClose}>&times;</button>
          <div className="feature-icon mx-auto mb-6">
            <ReminderIcon />
          </div>
          <h2 className="text-2xl font-bold gradient-text mb-4">Medication Reminder</h2>
          <p className="text-lg text-slate-700 mb-2">It's time to take your</p>
          <p className="text-2xl font-bold text-slate-800 mb-6">{reminder.name}</p>
          {loading && <p className="text-slate-500">Speaking reminder...</p>}
        </div>
      </div>
    );

    const RemindersPage = () => {
        const [reminders, setReminders] = useState([
          { id: 1, name: 'Paracetamol', time: '8:00 AM' },
          { id: 2, name: 'Amoxicillin', time: '12:00 PM' },
        ]);
        const [pillName, setPillName] = useState('');
        const [pillTime, setPillTime] = useState('');
        const [showModal, setShowModal] = useState(false);
        const [modalReminder, setModalReminder] = useState(null);
        const [ttsLoading, setTtsLoading] = useState(false);

        const handleAddReminder = (e) => {
          e.preventDefault();
          if (pillName && pillTime) {
            const newReminder = { id: Date.now(), name: pillName, time: pillTime };
            setReminders([...reminders, newReminder]);
            setPillName('');
            setPillTime('');
          }
        };

        const handleDeleteReminder = (id) => {
          setReminders(reminders.filter(r => r.id !== id));
        };

        return (
          <div className="page-container">
            <h1 className="page-title">Medication Reminders</h1>
            <p className="page-subtitle">Never miss a dose with smart medication reminders and notifications</p>

            <div className="form-premium">
              <div className="reminder-list">
                <h3 className="text-xl font-semibold gradient-text mb-6 text-center">Your Active Reminders</h3>
                {reminders.map(r => (
                  <div key={r.id} className="reminder-item group">
                    <div className="flex items-center gap-4">
                      <div className="feature-icon !w-12 !h-12 !mb-0">
                        <ReminderIcon />
                      </div>
                      <div>
                        <p className="font-semibold text-slate-800 text-lg">{r.name}</p>
                        <p className="text-slate-600">Daily at {r.time}</p>
                      </div>
                    </div>
                    <button 
                      onClick={() => handleDeleteReminder(r.id)} 
                      className="delete-btn opacity-0 group-hover:opacity-100"
                    >
                      <DeleteIcon />
                    </button>
                  </div>
                ))}
                {reminders.length === 0 && (
                  <div className="text-center py-12 text-slate-500">
                    <ReminderIcon />
                    <p className="mt-4">No reminders set yet</p>
                    <p className="text-sm">Add your first medication reminder below</p>
                  </div>
                )}
              </div>

              <div className="card-premium p-6 mt-8">
                <h3 className="text-xl font-semibold gradient-text mb-6 text-center">Add New Reminder</h3>
                <form onSubmit={handleAddReminder}>
                  <div className="input-group">
                    <input 
                      type="text" 
                      placeholder="Medication Name (e.g., Aspirin)" 
                      value={pillName} 
                      onChange={(e) => setPillName(e.target.value)} 
                      className="input-premium"
                      required 
                    />
                  </div>
                  <div className="input-group">
                    <input 
                      type="time" 
                      value={pillTime} 
                      onChange={(e) => setPillTime(e.target.value)} 
                      className="input-premium"
                      required 
                    />
                  </div>
                  <button type="submit" className="btn-premium">
                    <PlusIcon />
                    Add Reminder
                  </button>
                </form>
              </div>
            </div>

            {showModal && modalReminder && (
              <ReminderModal 
                reminder={modalReminder} 
                onClose={() => setShowModal(false)} 
                loading={ttsLoading} 
              />
            )}
          </div>
        );
    };

    // Main App Component
    const App = () => {
        const [token, setToken] = useState(null);
        const [currentPage, setCurrentPage] = useState('scan');
        const [message, setMessage] = useState('');
        const [loading, setLoading] = useState(false);
        const [email, setEmail] = useState('');
        const [password, setPassword] = useState('');

        useEffect(() => {
          setMessage('');
        }, [currentPage, token]);

        const renderPage = () => {
            const commonProps = { token, loading, setLoading, message, setMessage };
            if (!token) return <AuthPage {...{setToken, email, setEmail, password, setPassword, ...commonProps}} />;
            
            switch(currentPage) {
                case 'scan': return <ScanPage {...commonProps} />;
                case 'chatbot': return <ChatbotPage {...commonProps} />;
                case 'navigation': return <NavigationPage {...commonProps} />;
                case 'reminders': return <RemindersPage />;
                case 'dashboard': return <CaregiverDashboardPage />;
                default: return <ScanPage {...commonProps} />;
            }
        };

        const handleLogout = () => {
          setToken(null);
          setCurrentPage('scan');
          setEmail('');
          setPassword('');
        };

        return (
          <div className="app-container">
            {token && (
              <nav className="nav-header">
                <div className="nav-container">
                  <div className="logo-container">
                    <div className="logo-icon">
                      <svg width="24" height="24" viewBox="0 0 32 32" fill="none">
                        <path d="M16 2.66663C8.636 2.66663 2.66669 8.63596 2.66669 16C2.66669 23.364 8.636 29.3333 16 29.3333C23.364 29.3333 29.3334 23.364 29.3334 16C29.3334 8.63596 23.364 2.66663 16 2.66663ZM20 17.3333H17.3334V20C17.3334 20.7363 16.736 21.3333 16 21.3333C15.264 21.3333 14.6667 20.7363 14.6667 20V17.3333H12C11.264 17.3333 10.6667 16.7363 10.6667 16C10.6667 15.2636 11.264 14.6666 12 14.6666H14.6667V12C14.6667 11.2636 15.264 10.6666 16 10.6666C16.736 10.6666 17.3334 11.2636 17.3334 12V14.6666H20C20.736 14.6666 21.3334 15.2636 21.3334 16C21.3334 16.7363 20.736 17.3333 20 17.3333Z" fill="white"/>
                      </svg>
                    </div>
                    <h1 className="brand-text">MediSort</h1>
                  </div>

                  <div className="nav-tabs">
                    <button 
                      className={`nav-tab ${currentPage === 'scan' ? 'active' : ''}`} 
                      onClick={() => setCurrentPage('scan')}
                    >
                      <ScanIcon />Scan
                    </button>
                    <button 
                      className={`nav-tab ${currentPage === 'chatbot' ? 'active' : ''}`} 
                      onClick={() => setCurrentPage('chatbot')}
                    >
                      <ChatIcon/>AI Chat
                    </button>
                    <button 
                      className={`nav-tab ${currentPage === 'navigation' ? 'active' : ''}`} 
                      onClick={() => setCurrentPage('navigation')}
                    >
                      <NavigationIcon/>Navigation
                    </button>
                    <button 
                      className={`nav-tab ${currentPage === 'reminders' ? 'active' : ''}`} 
                      onClick={() => setCurrentPage('reminders')}
                    >
                      <ReminderIcon/>Reminders
                    </button>
                    <button 
                      className={`nav-tab ${currentPage === 'dashboard' ? 'active' : ''}`} 
                      onClick={() => setCurrentPage('dashboard')}
                    >
                      <DashboardIcon/>Dashboard
                    </button>
                  </div>

                  <button className="logout-btn" onClick={handleLogout}>
                    <LogoutIcon/>
                    Sign Out
                  </button>
                </div>
              </nav>
            )}

            <main className="main-content">
              {renderPage()}

              {message && !loading && currentPage !== 'dashboard' && (
                <div className={`message-display-premium ${message.includes('Error') ? 'error-message-premium' : 'success-message-premium'}`}>
                  {message.includes('Error') ? (
                    <span className="flex items-center justify-center gap-2">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="15" y1="9" x2="9" y2="15"/>
                        <line x1="9" y1="9" x2="15" y2="15"/>
                      </svg>
                      {message}
                    </span>
                  ) : (
                    <span className="flex items-center justify-center gap-2">
                      <SuccessIcon />
                      {message}
                    </span>
                  )}
                </div>
              )}
            </main>

            {/* Floating scroll to top button */}
            <button 
              className="floating-action-btn"
              onClick={() => window.scrollTo({ top: 0, behavior: 'smooth' })}
              title="Scroll to top"
            >
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="12" y1="19" x2="12" y2="5"/>
                <polyline points="5,12 12,5 19,12"/>
              </svg>
            </button>
          </div>
        );
    };

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>